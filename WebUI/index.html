<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/leaflet.css">
    <script src="js/leaflet.js"></script>
    <link href="css/stylesheet.css" rel="stylesheet">
</head>
<body>
    <div id="mySidenav" class="sidenav">
        <table style="color: black; width: 100%; padding-right: 20px">
            <tr>
                <th style="text-align: left; padding-left: 20px; width: 100%;">
                    <h2>Configuration</h2>
                </th>
                <th>
                    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()"><img src="icons/cancel.png" width=20/></a>
                </th>
            </tr>
        </table>
        <div id="selections">
            <h3>Select Country</h3>
            <form>
              <select id="country" name="country">
              </select>
            </form>
            <h3>Select Year</h3>
            <form>
              <select id="year" name="year">
                <option value="1994">1994</option>
                <option value="1995">1995</option>
                <option value="1996">1996</option>
              </select>
            </form>
            <h3>Select Category</h3>
            <form>
              <select id="category" name="category">
                  <option value="Crop Land">Crop Land</option>
                  <option value="Fish">Fish</option>
                  <option value="Forest">Forest</option>
                  <option value="Grazing">Grazing</option>
                  <option value="Urban Land">Urban Land</option>
              </select>
            </form>
            <br>
            <button id="btnSimulate">Simulate</button>
            <button>Reset</button>            
        </div>
    </div>
    <div id=header>
        <table style="color: white; width: 100%;">
            <tr>
                <th style="text-align: left; padding-left: 20px; width: 100%"><h2>Ecological Footprint Simulator</h2></th>
                <th><span style="text-align: right;font-size:30px;cursor:pointer;padding-right: 15px" onclick="openNav()">Configuration</span></th>
            </tr>
        </table>
    </div>
    <div id="mapid"></div>
    <script>
        let countryDict = {}
        let dropdownCountries = document.getElementById("country");
        let btnSimulate = document.getElementById("btnSimulate");

        function sendRequest(requestType, url, parameters, responseType){
            let request = new XMLHttpRequest();
            request.responseType = responseType
            request.addEventListener("readystatechange", function(){
                //For pre-defined ready state constants,
                //refer to: https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/readyState 
                if(request.readyState == 4 && request.status == 200){
                    console.log(request.response);
                    //countryDict = new Map(Object.entries(request.response));
                }
            });
            request.open(requestType, (url+parameters), true);
            request.send(null);
        }

        function populateCountryDropdown(){
            sendRequest("GET", "http://127.0.0.1:5000/countries", "", "json");
            for(let key of countryDict.keys()){
                let newCountryOption = document.createElement("option");
                newCountryOption.setAttribute("value", key);
                newCountryOption.text = key;
                dropdownCountries.appendChild(newCountryOption);
            }
        }

        populateCountryDropdown();
    </script>
    <script src="js/navbar.js"></script>
    <script src="js/initmap.js"></script>
    <script src="js/pinnedlocation.js"></script>
</body>
</html>